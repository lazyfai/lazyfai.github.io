---
layout: post
title: Eee PC 中的小學問 - 有關檔案系統
date: '2007-10-31T11:20:00.000+08:00'
author: Fai Wong
tags:
- eee
modified_time: '2007-10-31T15:10:45.891+08:00'
thumbnail: http://2.bp.blogspot.com/_ZwYFGbHC6Q8/RygqZblG47I/AAAAAAAAA14/dXchK9PAVi0/s72-c/xepc-1.jpg
blogger_id: tag:blogger.com,1999:blog-8503500.post-2029263458944757610
blogger_orig_url: http://lazyfai.blogspot.com/2007/10/eee-pc_31.html
---

<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_ZwYFGbHC6Q8/RygqZblG47I/AAAAAAAAA14/dXchK9PAVi0/s1600-h/xepc-1.jpg"><img style="cursor: pointer;" src="http://2.bp.blogspot.com/_ZwYFGbHC6Q8/RygqZblG47I/AAAAAAAAA14/dXchK9PAVi0/s320/xepc-1.jpg" alt="" id="BLOGGER_PHOTO_ID_5127394792149803954" border="0" /></a><br /><br />1. AMI BIOS<br />2. 開機畫面 (Grub吧)<br />3. 裝載（只讀） /dev/sda1 為 / 檔案系統，執行 /sbin/fastinit<br />4. 使用 unionfs 裝載（可寫入） /dev/sda2 為 / 檔案系統上的 overlay  *<br />5. 開始的時候 fastinit 會載入硬體的驅動程式 (LAN, wifi 等)<br />6. 運行 startx, startx 會執行 icewm 和華碩自己的 GUI - AsusLauncher<br />7. 開機完成，大約16秒<br /><br />* 有關 overlay<br />很久以前的 Linux Live CD 都是只讀的系統，很多程式不喜歡這種限制的環境，<br />而且只有 650M 左右的地方放檔案，不足夠。<br />後來就出現了壓縮檔案系統 - squashfs，大大的壓縮比，解決了空間的問題，<br />可是還只是唯讀。<br />最後出現了一個兩全其美的解決方法 - squashfs 加上 unionfs，unionfs<br />的作法是把兩個分割區或者檔案系統堆叠(stack)在一起，有任何寫入/刪除<br />的動作都做在最後 stack 上去的檔案系統，因此 Live CD 可以用 squashfs<br />做底層，再用記憶體做 RAM Disk 放上面，模擬一個“正常”的檔案系統給<br />Live 操作系統用了。<br />在 Eee PC 上，華碩運用了這個原理做出可以隨時還完的方法，就是把預設的<br />系統都放到 sda1 上，裝載成唯讀（就像Live CD），再把 sda2 堆叠上去<br />成可寫入，那麼無論用戶怎樣玩死這個系統，sda1也是原來的樣子，所謂<br />還原只是把 sda2 重新格式化就行了。<br />華碩這個設計真聰明！<br /><br />[這篇文章同時發佈在 <a href="http://www.xepc.org/">XEPC.org</a>]