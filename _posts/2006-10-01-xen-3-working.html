---
layout: post
title: XEN 3 working!
date: '2006-10-01T13:10:00.000+08:00'
author: Fai Wong
tags:
- linux
modified_time: '2006-10-01T13:15:58.734+08:00'
blogger_id: tag:blogger.com,1999:blog-8503500.post-5772645686303631483
blogger_orig_url: http://lazyfai.blogspot.com/2006/10/xen-3-working.html
---

Finally made XEN working on my gentoo box.<br />For record:<br />1.  emerge xen-sources<br />2. copy using kernel config to .config, then make oldconfig<br />3. make menuconfig and enable dom0 support, and those backend and frontend drivers<br />4. make the kernel and modules, install, reboot from that new kernel, but remember to edit grub.conf or menu.lst:<br />title Gentoo Linux (xen)<br />        root (hd0,1)<br />        kernel (hd0,1)/xen.gz dom0_mem=384M<br />        module (hd0,1)/kernel-genkernel-x86-xen0-2.6.16.28-xen root=/dev/hda5 quiet<br />5. install xen utilities, start at bootup<br />6. get some distribution images to test :-)<br />7. make domU kernel and modules by the same kernel source, but remove dom0 support,<br /> and those backend drivers<br />8. mount the distribution image, copy the kernel modules for domU into it<br />7. config the xend for network bridge in /etc/xen/xend-config.sxp:<br />(network-script network-bridge)<br />(vif-script vif-bridge)<br />8. remember to turn on ip forwarding in /proc/sys/net/ipv4/ip_forward<br />9. umount the distribution image<br />10. config the distribution config file, eg. for debian 3.1 image:<br />name = "debian.3-1"<br />memory = 128<br />vif = [ 'ip=192.168.0.200' ]<br />kernel = "/xen-vm/kernels/boot/vmlinuz-2.6.16.8-xenU"<br />disk = ['file:/xen-vm/debian.3-1.img,sda1,w', 'file:/xen-vm/debian.swap,sda2,w']root = "/dev/sda1 ro"<br />11. after all, reboot and enjoy :-)